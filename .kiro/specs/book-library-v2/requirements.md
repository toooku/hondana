# 蔵書管理アプリケーション v2 - 要件定義書

## 概要

蔵書管理アプリケーションの拡張版。v1の機能に加えて、バーコード読み取り、読書ステータス管理、書影表示、Markdownベースの感想管理を追加。より豊かな読書体験と効率的な蔵書管理を実現する。

## 用語集

- **バーコード読み取り**: Webカメラを使用してISBNバーコードを自動認識する機能
- **読書ステータス**: 積読（未読）、読書中、読了の3つの状態
- **書影**: 本の表紙画像。OpenBD APIから取得
- **感想ファイル**: 本ごとに1つのMarkdownファイルで管理される感想
- **ステータス履歴**: 読書ステータスの変更記録

## 要件

### 要件1: バーコード読み取り機能

**ユーザーストーリー**: ユーザーとして、Webカメラを使用してISBNバーコードを読み取り、自動的に本を登録したい。そうすることで、手動でISBNを入力する手間を削減したい。

#### 受け入れ基準

1. WHEN バーコード読み取り画面を開く THEN システムはWebカメラへのアクセスを要求し、カメラ映像をリアルタイムで表示する
2. WHEN バーコードがカメラに映る THEN システムはISBNを自動認識し、画面に表示する
3. WHEN 認識されたISBNを確認して登録ボタンを押す THEN システムはOpenBD APIから書誌情報を取得し、本を登録する
4. WHEN バーコード読み取りに失敗する THEN システムはエラーメッセージを表示し、再度読み取りを試みることができる

### 要件2: 読書ステータス管理

**ユーザーストーリー**: ユーザーとして、各本の読書進捗を「積読」「読書中」「読了」で管理したい。そうすることで、読書状況を一目で把握できる。

#### 受け入れ基準

1. WHEN 本を登録する THEN システムはデフォルトで「積読」ステータスを設定する
2. WHEN 本のステータスを変更する THEN システムは新しいステータスを保存し、変更日時を記録する
3. WHEN ステータスが変更される THEN システムは変更履歴を記録し、いつどのステータスに変更されたかを追跡できる
4. WHEN 静的サイトを生成する THEN システムはステータスごとに本を分類して表示する

### 要件3: 書影表示

**ユーザーストーリー**: ユーザーとして、静的サイトに本の表紙画像を表示したい。そうすることで、蔵書をより視覚的に閲覧できる。

#### 受け入れ基準

1. WHEN 本を登録する THEN システムはOpenBD APIから書影URLを取得し、保存する
2. WHEN 書影URLが取得できない THEN システムはデフォルト画像を使用する
3. WHEN 静的サイトを生成する THEN システムは本の詳細ページに書影を表示する
4. WHEN 本一覧ページを表示する THEN システムは各本のカード上に書影を表示する

### 要件4: Markdownベースの感想管理

**ユーザーストーリー**: ユーザーとして、長い感想をMarkdownファイルで管理したい。そうすることで、より詳細で構造化された感想を記録できる。

#### 受け入れ基準

1. WHEN 本に感想を追加する THEN システムは本ごとに1つのMarkdownファイルを作成し、感想を保存する
2. WHEN 感想ファイルが存在する THEN システムはMarkdownファイルから感想を読み込み、表示する
3. WHEN 感想を編集する THEN システムはMarkdownファイルを更新し、変更を保存する
4. WHEN 静的サイトを生成する THEN システムはMarkdownファイルをHTMLに変換して表示する

### 要件5: 統合されたUI/UX

**ユーザーストーリー**: ユーザーとして、バーコード読み取り、ステータス管理、書影表示、感想管理がシームレスに統合されたインターフェースを使用したい。

#### 受け入れ基準

1. WHEN CLIで本を管理する THEN システムはステータス変更、感想編集などの操作を簡単に実行できる
2. WHEN 静的サイトを表示する THEN システムはステータスごとの分類、書影、Markdown形式の感想をすべて表示する
3. WHEN Webインターフェースを使用する THEN システムはバーコード読み取り、ステータス管理、感想編集をWebブラウザで実行できる

### 要件6: データ互換性

**ユーザーストーリー**: ユーザーとして、v1で作成したデータがv2でも使用できることを確認したい。

#### 受け入れ基準

1. WHEN v1のデータファイルをv2で読み込む THEN システムは既存のデータを正しく解析し、新しいフィールドにデフォルト値を設定する
2. WHEN v1のデータを移行する THEN システムは既存の感想をMarkdownファイルに変換する
3. WHEN 移行後にデータを保存する THEN システムはv2の形式で保存し、v1との互換性を保つ
